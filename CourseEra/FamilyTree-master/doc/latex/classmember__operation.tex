\hypertarget{classmember__operation}{\section{member\-\_\-operation Class Reference}
\label{classmember__operation}\index{member\-\_\-operation@{member\-\_\-operation}}
}
Inheritance diagram for member\-\_\-operation\-:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=3.000000cm]{classmember__operation}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classmember__operation_a6878b5586bd9ea7e86c0ec19750437ca}{\-\_\-\-\_\-construct} (\$memberid)
\item 
\hyperlink{classmember__operation_aaae269a6cda847ad7aaffad933fe0ee6}{populate\-\_\-data} (\$memberid)
\item 
\hyperlink{classmember__operation_a6262e1076fe11fe6c0ef4311bfb79ac7}{add\-\_\-son} (\$name, \$gender, \$\hyperlink{classsuggest}{suggest}=false)
\item 
\hyperlink{classmember__operation_ad769e90d19b213f2d74966d5c1ea2af3}{hasspouse} ()
\item 
\hyperlink{classmember__operation_a98d050cd93cb97b426d8971a827159b1}{addwife} (\$name=\char`\"{}Wife\char`\"{}, \$suggest=false)
\item 
\hyperlink{classmember__operation_adc35cdeaaa4979bf5b8d602dd4f2b529}{addhusband} (\$name=\char`\"{}Husband\char`\"{}, \$suggest=false)
\item 
\hyperlink{classmember__operation_ac684b0752ce7aeafd21aab1aed081711}{remove} (\$\hyperlink{classsuggest}{suggest}=false)
\item 
\hyperlink{classmember__operation_ada4a29c07083c0b2986e5960ef223bed}{edit} (\$name, \$gender, \$relationship, \$dob, \$alive, \$\hyperlink{classsuggest}{suggest}=F\-A\-L\-S\-E)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hypertarget{classmember__operation_a734eb4b1794b8d73016ab6e47fef1b7c}{{\bfseries \$id}}\label{classmember__operation_a734eb4b1794b8d73016ab6e47fef1b7c}

\item 
\hypertarget{classmember__operation_aca6848da2c5d1928b415345ab7a1492b}{{\bfseries \$data}}\label{classmember__operation_aca6848da2c5d1928b415345ab7a1492b}

\end{DoxyCompactItemize}


\subsection{Detailed Description}
This class handles Member Entity To be Only used by other classes

\begin{DoxyAuthor}{Author}
piyush 
\end{DoxyAuthor}


Definition at line 11 of file member\-\_\-operation.\-php.



\subsection{Constructor \& Destructor Documentation}
\hypertarget{classmember__operation_a6878b5586bd9ea7e86c0ec19750437ca}{\index{member\-\_\-operation@{member\-\_\-operation}!\-\_\-\-\_\-construct@{\-\_\-\-\_\-construct}}
\index{\-\_\-\-\_\-construct@{\-\_\-\-\_\-construct}!member_operation@{member\-\_\-operation}}
\subsubsection[{\-\_\-\-\_\-construct}]{\setlength{\rightskip}{0pt plus 5cm}member\-\_\-operation\-::\-\_\-\-\_\-construct (
\begin{DoxyParamCaption}
\item[{}]{\$memberid}
\end{DoxyParamCaption}
)}}\label{classmember__operation_a6878b5586bd9ea7e86c0ec19750437ca}
Constructor of the class 
\begin{DoxyParams}[1]{Parameters}
integer & {\em \$memberid} & The I\-D of the member \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
null 
\end{DoxyReturn}


Definition at line 30 of file member\-\_\-operation.\-php.


\begin{DoxyCode}
30                                            \{
31         $this->\textcolor{keywordtype}{id} = $memberid;
32     \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\hypertarget{classmember__operation_a6262e1076fe11fe6c0ef4311bfb79ac7}{\index{member\-\_\-operation@{member\-\_\-operation}!add\-\_\-son@{add\-\_\-son}}
\index{add\-\_\-son@{add\-\_\-son}!member_operation@{member\-\_\-operation}}
\subsubsection[{add\-\_\-son}]{\setlength{\rightskip}{0pt plus 5cm}member\-\_\-operation\-::add\-\_\-son (
\begin{DoxyParamCaption}
\item[{}]{\$name, }
\item[{}]{\$gender, }
\item[{}]{\$suggest = {\ttfamily false}}
\end{DoxyParamCaption}
)}}\label{classmember__operation_a6262e1076fe11fe6c0ef4311bfb79ac7}
\-: Change name of the function. Misleading it is as it also works for daughters.

This function is used to add a child of the member. Returns false on error   \$db The instance of db class 
\begin{DoxyParams}[1]{Parameters}
string & {\em \$name} & The name of the new member \\
\hline
integer & {\em \$gender} & The gender of the new member \\
\hline
boolean & {\em \$suggest} & If this is a suggestion then set this to true \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
integer The I\-D of the new member just added 
\end{DoxyReturn}


Definition at line 61 of file member\-\_\-operation.\-php.


\begin{DoxyCode}
61                                                        \{
62         global $vanshavali, $user;
63 
64         \textcolor{comment}{//Check for member to member access}
65         $hasAccess = $vanshavali->hasAccess($user->user[\textcolor{stringliteral}{'id'}], $this->id);
66 
67         \textcolor{keywordflow}{if} ($suggest & !$hasAccess) \{
68             \textcolor{keywordflow}{if} (intval($this->data[\textcolor{stringliteral}{'gender'}]) == MALE) \{
69 
70                 \textcolor{comment}{//If a male member then send his id}
71                 \textcolor{keywordflow}{return} parent::add\_son\_suggest($name, $gender, $this->data[\textcolor{stringliteral}{'id'}]);
72             \} \textcolor{keywordflow}{else} \{
73 
74                 \textcolor{comment}{//If not a male member then send the id of the spouse}
75                 \textcolor{keywordflow}{return} parent::add\_son\_suggest($name, $gender, $this->data[\textcolor{stringliteral}{'related\_to'}]);
76             \}
77         \} \textcolor{keywordflow}{else} \{
78 
79             \textcolor{comment}{//Before doing all this check if the member has a wife}
80             \textcolor{keywordflow}{if} ($this->\hyperlink{classmember__operation_ad769e90d19b213f2d74966d5c1ea2af3}{hasspouse}()) \{
81 
82                 \textcolor{comment}{//Add son directly to the Member database}
83                 global $db;
84 
85                 \textcolor{comment}{//Get the familyid of the parent}
86 
87                 \textcolor{comment}{/* @var $familyid integer */}
88                 $familyid = $this->data[\textcolor{stringliteral}{'family\_id'}];
89                 \textcolor{keywordflow}{if} (empty($familyid)) \{
90 
91                     \textcolor{comment}{//If family id is not defined than assume that he/she belongs to the default family}
92                     trigger\_error(\textcolor{stringliteral}{"Empty Family. Don't belong to any Family"}, E\_USER\_ERROR);
93                 \}
94 
95 
96                 \textcolor{comment}{//Prepare the sql according to the gender}
97                 $sql = \textcolor{stringliteral}{""};
98                 \textcolor{keywordflow}{if} (intval($this->data[\textcolor{stringliteral}{'gender'}]) === FEMALE) \{
99                     $sql = \textcolor{stringliteral}{"Insert into member(membername,gender,sonof,family\_id) }
100 \textcolor{stringliteral}{                values('$name',$gender,"} . $this->data[\textcolor{stringliteral}{'related\_to'}] . \textcolor{stringliteral}{",$familyid)"};
101                 \} \textcolor{keywordflow}{else} \{
102                     $sql = \textcolor{stringliteral}{"Insert into member(membername,gender,sonof,family\_id) }
103 \textcolor{stringliteral}{                values('$name',$gender,"} . $this->data[\textcolor{stringliteral}{'id'}] . \textcolor{stringliteral}{",$familyid)"};
104                 \}
105 
106                 \textcolor{comment}{//Execute the sql}
107                 \textcolor{keywordflow}{if} (!$db->get($sql)) \{
108                     trigger\_error(\textcolor{stringliteral}{"Cannot add member. Error executing the query"});
109                     \textcolor{keywordflow}{return} \textcolor{keyword}{false};
110                 \}
111                 \textcolor{keywordflow}{return} mysql\_insert\_id();
112             \} \textcolor{keywordflow}{else} \{
113                 \textcolor{keywordflow}{return} \textcolor{keyword}{false};
114             \}
115         \}
116     \}
\end{DoxyCode}
\hypertarget{classmember__operation_adc35cdeaaa4979bf5b8d602dd4f2b529}{\index{member\-\_\-operation@{member\-\_\-operation}!addhusband@{addhusband}}
\index{addhusband@{addhusband}!member_operation@{member\-\_\-operation}}
\subsubsection[{addhusband}]{\setlength{\rightskip}{0pt plus 5cm}member\-\_\-operation\-::addhusband (
\begin{DoxyParamCaption}
\item[{}]{\$name = {\ttfamily \char`\"{}Husband\char`\"{}}, }
\item[{}]{\$suggest = {\ttfamily false}}
\end{DoxyParamCaption}
)}}\label{classmember__operation_adc35cdeaaa4979bf5b8d602dd4f2b529}
This function is used to add husband to the member. It returns true on successfull operation.   \$vanshavali Instance of the  class   \$db Instance of the  class 
\begin{DoxyParams}[1]{Parameters}
string & {\em \$name} & The name of the husband \\
\hline
boolean & {\em \$suggest} & Set to true if is a suggestion \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
boolean 
\end{DoxyReturn}


Definition at line 190 of file member\-\_\-operation.\-php.


\begin{DoxyCode}
190                                                              \{
191         global $vanshavali, $user;
192 
193         $hasAccess = $vanshavali->hasAccess($user->user[\textcolor{stringliteral}{'id'}], $this->id);
194 
195         \textcolor{keywordflow}{if} ($suggest && !$hasAccess) \{
196             \textcolor{keywordflow}{return} parent::addhusband\_suggest($name, $this->\textcolor{keywordtype}{id});
197         \} \textcolor{keywordflow}{else} \{
198 
199             \textcolor{comment}{//Add wife directly in the database}
200             $family\_id = $vanshavali->addfamily($name . \textcolor{stringliteral}{"'s Family"});
201             \textcolor{keywordflow}{if} ($family\_id) \{
202                 \textcolor{comment}{// Now add parents with that family id}
203                 $fatherid = $vanshavali->addmember\_explicit(\textcolor{stringliteral}{"Father"}, 0, $family\_id);
204                 $motherid = $vanshavali->addmember\_explicit(\textcolor{stringliteral}{"Mother"}, 1, $family\_id);
205 
206                 $father = $vanshavali->getmember($fatherid);
207                 $mother = $vanshavali->getmember($motherid);
208 
209                 $mother->related\_to($fatherid);
210                 $father->related\_to($motherid);
211 
212                 $wife = \textcolor{keyword}{new} \hyperlink{classmember}{member}($father->add\_son(\textcolor{stringliteral}{"Wife"}, 0));
213                 $this->related\_to($wife->id);
214                 $this->set\_relationship(1);
215                 $wife->related\_to($this->\textcolor{keywordtype}{id});
216                 $wife->set\_relationship(1);
217                 \textcolor{keywordflow}{return} \textcolor{keyword}{true};
218             \} \textcolor{keywordflow}{else} \{
219                 \textcolor{keywordflow}{return} \textcolor{keyword}{false};
220             \}
221         \}
222     \}
\end{DoxyCode}
\hypertarget{classmember__operation_a98d050cd93cb97b426d8971a827159b1}{\index{member\-\_\-operation@{member\-\_\-operation}!addwife@{addwife}}
\index{addwife@{addwife}!member_operation@{member\-\_\-operation}}
\subsubsection[{addwife}]{\setlength{\rightskip}{0pt plus 5cm}member\-\_\-operation\-::addwife (
\begin{DoxyParamCaption}
\item[{}]{\$name = {\ttfamily \char`\"{}Wife\char`\"{}}, }
\item[{}]{\$suggest = {\ttfamily false}}
\end{DoxyParamCaption}
)}}\label{classmember__operation_a98d050cd93cb97b426d8971a827159b1}
This function is used to add wife to the member. Returns true if successfull operation else returns false   \$vanshavali The instance of the  class   \$db The instance of the  class 
\begin{DoxyParams}[1]{Parameters}
string & {\em \$name} & The name of Wife \\
\hline
boolean & {\em \$suggest} & Set to true if this is a suggestion \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
boolean 
\end{DoxyReturn}


Definition at line 145 of file member\-\_\-operation.\-php.


\begin{DoxyCode}
145                                                        \{
146         global $vanshavali, $user;
147 
148         \textcolor{keywordflow}{if} ($suggest && !$hasAccess) \{
149             \textcolor{keywordflow}{return} parent::addwife\_suggest($name, $this->\textcolor{keywordtype}{id});
150         \} \textcolor{keywordflow}{else} \{
151 
152             \textcolor{comment}{//Firstly to check if the member already has a wife}
153             \textcolor{keywordflow}{if} (!$this->\hyperlink{classmember__operation_ad769e90d19b213f2d74966d5c1ea2af3}{hasspouse}()) \{
154                 \textcolor{comment}{//Add wife directly in the database}
155                 $father\_family\_id = $vanshavali->addfamily($name);
156                 $mother\_family\_id = $vanshavali->addfamily($name);
157                 \textcolor{keywordflow}{if} ($father\_family\_id && $mother\_family\_id) \{
158                     \textcolor{comment}{// Now add parents with that family id}
159                     $fatherid = $vanshavali->addmember\_explicit(\textcolor{stringliteral}{"Father"}, MALE, $father\_family\_id);
160                     $motherid = $vanshavali->addmember\_explicit(\textcolor{stringliteral}{"Mother"}, FEMALE, $mother\_family\_id);
161 
162                     $father = $vanshavali->getmember($fatherid);
163                     $mother = $vanshavali->getmember($motherid);
164 
165                     $mother->related\_to($fatherid);
166                     $father->related\_to($motherid);
167 
168                     $wife = \textcolor{keyword}{new} \hyperlink{classmember}{member}($father->add\_son(\textcolor{stringliteral}{"Wife"}, FEMALE));
169                     $this->related\_to($wife->id);
170                     $this->set\_relationship(MARRIED);
171                     $wife->related\_to($this->\textcolor{keywordtype}{id});
172                     $wife->set\_relationship(MARRIED);
173                     \textcolor{keywordflow}{return} \textcolor{keyword}{true};
174                 \} \textcolor{keywordflow}{else} \{
175                     \textcolor{keywordflow}{return} \textcolor{keyword}{false};
176                 \}
177             \}
178         \}
179     \}
\end{DoxyCode}
\hypertarget{classmember__operation_ada4a29c07083c0b2986e5960ef223bed}{\index{member\-\_\-operation@{member\-\_\-operation}!edit@{edit}}
\index{edit@{edit}!member_operation@{member\-\_\-operation}}
\subsubsection[{edit}]{\setlength{\rightskip}{0pt plus 5cm}member\-\_\-operation\-::edit (
\begin{DoxyParamCaption}
\item[{}]{\$name, }
\item[{}]{\$gender, }
\item[{}]{\$relationship, }
\item[{}]{\$dob, }
\item[{}]{\$alive, }
\item[{}]{\$suggest = {\ttfamily FALSE}}
\end{DoxyParamCaption}
)}}\label{classmember__operation_ada4a29c07083c0b2986e5960ef223bed}
This function is used to edit a user details. Returns true on successful operation else returns false   \$db 
\begin{DoxyParams}[1]{Parameters}
string & {\em \$name} & The new name of the member \\
\hline
integer & {\em \$gender} & The new gender of the member. See Below. \\
\hline
integer & {\em \$relationship} & The relationship status of the member See Below. \\
\hline
integer & {\em \$dob} & The Timestamp of the D\-O\-B of the member \\
\hline
Integer & {\em \$alive} & The living status of the member \\
\hline
boolean & {\em \$suggest} & Set to true if this is a suggest \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
boolean
\end{DoxyReturn}
Gender 0 == Male 1 == Female

Relationship Status 0 == Single 1 == Married

Alive 0 == Deceased 1 == Living 

Definition at line 277 of file member\-\_\-operation.\-php.


\begin{DoxyCode}
277                                                                                  \{
278         global $vanshavali, $user;
279 
280         $hasAccess = $vanshavali->hasAccess($user->user[\textcolor{stringliteral}{'id'}], $this->id);
281 
282         \textcolor{keywordflow}{if} ($suggest && !$hasAccess) \{
283             \textcolor{keywordflow}{return} parent::edit\_suggest($name, $gender, $relationship, $dob, $alive, $this->data[\textcolor{stringliteral}{'id'}]);
284         \} \textcolor{keywordflow}{else} \{
285             \textcolor{comment}{//Change the details directly...}
286             global $db;
287 
288             \textcolor{comment}{//Prepare the sql and execute it...}
289             \textcolor{keywordflow}{if} (!$db->get(\textcolor{stringliteral}{"Update member set membername='$name',gender=$gender,}
290 \textcolor{stringliteral}{                relationship\_status=$relationship,dob=$dob, alive=$alive where id="} . $this->data[\textcolor{stringliteral}{'id'}])) \{
291                 trigger\_error(\textcolor{stringliteral}{"Error Editing member. Error Executing query"});
292                 \textcolor{keywordflow}{return} FALSE;
293             \}
294         \}
295 
296         \textcolor{comment}{//If reached till here, then the operation is complete}
297         \textcolor{keywordflow}{return} True;
298     \}
\end{DoxyCode}
\hypertarget{classmember__operation_ad769e90d19b213f2d74966d5c1ea2af3}{\index{member\-\_\-operation@{member\-\_\-operation}!hasspouse@{hasspouse}}
\index{hasspouse@{hasspouse}!member_operation@{member\-\_\-operation}}
\subsubsection[{hasspouse}]{\setlength{\rightskip}{0pt plus 5cm}member\-\_\-operation\-::hasspouse (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classmember__operation_ad769e90d19b213f2d74966d5c1ea2af3}
This function is used to check if check if the member has a spouse or not Returns true If the member has spouse else returns false   \$db The instance of the db class \begin{DoxyReturn}{Returns}
boolean 
\end{DoxyReturn}


Definition at line 124 of file member\-\_\-operation.\-php.


\begin{DoxyCode}
124                          \{
125         global $db;
126 
127         $row = $db->get(\textcolor{stringliteral}{"select related\_to from member where id="} . $this->\textcolor{keywordtype}{id});
128 
129         \textcolor{keywordflow}{if} (!empty($row[\textcolor{stringliteral}{'related\_to'}])) \{
130             \textcolor{keywordflow}{return} \textcolor{keyword}{true};
131         \} \textcolor{keywordflow}{else} \{
132             \textcolor{keywordflow}{return} \textcolor{keyword}{false};
133         \}
134     \}
\end{DoxyCode}
\hypertarget{classmember__operation_aaae269a6cda847ad7aaffad933fe0ee6}{\index{member\-\_\-operation@{member\-\_\-operation}!populate\-\_\-data@{populate\-\_\-data}}
\index{populate\-\_\-data@{populate\-\_\-data}!member_operation@{member\-\_\-operation}}
\subsubsection[{populate\-\_\-data}]{\setlength{\rightskip}{0pt plus 5cm}member\-\_\-operation\-::populate\-\_\-data (
\begin{DoxyParamCaption}
\item[{}]{\$memberid}
\end{DoxyParamCaption}
)}}\label{classmember__operation_aaae269a6cda847ad7aaffad933fe0ee6}
This function is used to fill the \$data variable with member data   \$db The instance of the  class 
\begin{DoxyParams}[1]{Parameters}
integer & {\em \$memberid} & The I\-D of the member \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
null 
\end{DoxyReturn}


Definition at line 40 of file member\-\_\-operation.\-php.


\begin{DoxyCode}
40                                       \{
41         \textcolor{comment}{// Fill user variable with user data}
42         global $db;
43         $query = $db->query(\textcolor{stringliteral}{"Select * from member where id=$memberid"});
44         $row = $db->fetch($query);
45         $this->data = $row;
46 
47         \textcolor{comment}{//Adding a check for the name. This is when user forgets to add name in the suggestion.}
48         $row[\textcolor{stringliteral}{'membername'}] = trim($row[\textcolor{stringliteral}{'membername'}]) == \textcolor{stringliteral}{""} ? \textcolor{stringliteral}{"unknown"} : $row[\textcolor{stringliteral}{'membername'}];
49     \}
\end{DoxyCode}
\hypertarget{classmember__operation_ac684b0752ce7aeafd21aab1aed081711}{\index{member\-\_\-operation@{member\-\_\-operation}!remove@{remove}}
\index{remove@{remove}!member_operation@{member\-\_\-operation}}
\subsubsection[{remove}]{\setlength{\rightskip}{0pt plus 5cm}member\-\_\-operation\-::remove (
\begin{DoxyParamCaption}
\item[{}]{\$suggest = {\ttfamily false}}
\end{DoxyParamCaption}
)}}\label{classmember__operation_ac684b0752ce7aeafd21aab1aed081711}
This function is used to remove the member from the database Returns true on successfull operation else false   \$db Instance of the  class 
\begin{DoxyParams}[1]{Parameters}
boolean & {\em \$suggest} & Set to true if is a suggestion \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
boolean 
\end{DoxyReturn}


Definition at line 231 of file member\-\_\-operation.\-php.


\begin{DoxyCode}
231                                       \{
232 
233         global $vanshavali, $user;
234 
235         $hasAccess = $vanshavali->hasAccess($user->user[\textcolor{stringliteral}{'id'}], $this->id);
236         \textcolor{keywordflow}{if} ($suggest && !$hasAccess) \{
237             \textcolor{keywordflow}{return} parent::remove\_suggest($this->data[\textcolor{stringliteral}{'id'}]);
238         \} \textcolor{keywordflow}{else} \{
239             \textcolor{comment}{//Remove the member completely}
240             global $db;
241 
242             \textcolor{comment}{//Prepare the sql}
243             \textcolor{keywordflow}{if} (!$db->get(\textcolor{stringliteral}{"Update member set dontshow=1 where id="} . $this->data[\textcolor{stringliteral}{'id'}])) \{
244                 trigger\_error(\textcolor{stringliteral}{"Cannot delete member. Error Executing the query"});
245                 \textcolor{keywordflow}{return} \textcolor{keyword}{false};
246             \}
247         \}
248 
249         \textcolor{comment}{//If reached here, then the operations is complete}
250         \textcolor{keywordflow}{return} \textcolor{keyword}{true};
251     \}
\end{DoxyCode}


The documentation for this class was generated from the following file\-:\begin{DoxyCompactItemize}
\item 
vanshavali/member\-\_\-operation.\-php\end{DoxyCompactItemize}
