<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Family Tree: install Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Family Tree
   &#160;<span id="projectnumber">0.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classinstall.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="classinstall-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">install Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a6a8bcb2f7b567c588f4a474d46804440"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinstall.html#a6a8bcb2f7b567c588f4a474d46804440">install</a> ()</td></tr>
<tr class="separator:a6a8bcb2f7b567c588f4a474d46804440"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e720dd6e62b63da8033cecf60d5eaed"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinstall.html#a4e720dd6e62b63da8033cecf60d5eaed">check_directory_permission</a> ($mode, $sub)</td></tr>
<tr class="separator:a4e720dd6e62b63da8033cecf60d5eaed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c80f436b583ec38915827619d1e0fa1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinstall.html#a5c80f436b583ec38915827619d1e0fa1">setupAdmin</a> ($mode, $sub)</td></tr>
<tr class="separator:a5c80f436b583ec38915827619d1e0fa1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27e554353c8f7b9eef9bc401f11765cf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinstall.html#a27e554353c8f7b9eef9bc401f11765cf">ask_database_name</a> ($mode, $sub)</td></tr>
<tr class="separator:a27e554353c8f7b9eef9bc401f11765cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a8b2e00c7cc9a5031e9c98b4b6aa2c035"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinstall.html#a8b2e00c7cc9a5031e9c98b4b6aa2c035">setup_database</a> ()</td></tr>
<tr class="separator:a8b2e00c7cc9a5031e9c98b4b6aa2c035"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d4d4748cd5c10e21c951a75e5a55f10"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinstall.html#a7d4d4748cd5c10e21c951a75e5a55f10">installTables</a> ()</td></tr>
<tr class="separator:a7d4d4748cd5c10e21c951a75e5a55f10"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p>Definition at line <a class="el" href="install_8php_source.html#l00011">11</a> of file <a class="el" href="install_8php_source.html">install.php</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a27e554353c8f7b9eef9bc401f11765cf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">install::ask_database_name </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$sub</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function is used ask the user about the database details </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$mode</td><td>Describes which phase is currently running </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$sub</td><td>Describes which part is running of the phase </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>null </dd></dl>

<p>Definition at line <a class="el" href="install_8php_source.html#l00156">156</a> of file <a class="el" href="install_8php_source.html">install.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                                            {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        global $template, $db;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        $sub = ($sub == null) ? 1 : $sub;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordflow">if</span> ($sub == 1) {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            $template-&gt;header();</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            $template-&gt;display(<span class="stringliteral">&quot;install.ask_database_details.tpl&quot;</span>);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        } elseif ($sub == 2) {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            $host = $_POST[<span class="stringliteral">&#39;database_host&#39;</span>];</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            $username = $_POST[<span class="stringliteral">&#39;database_username&#39;</span>];</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            $password = $_POST[<span class="stringliteral">&#39;database_password&#39;</span>];</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            $database = $_POST[<span class="stringliteral">&#39;database_name&#39;</span>];</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            $adminEmail = $_POST[<span class="stringliteral">&#39;admin_email&#39;</span>];</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            <span class="keywordflow">if</span> (empty($host) ||</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                    empty($username) ||</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                    empty($password) ||</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                    empty($database) ||</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                    empty($adminEmail)) {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                $template-&gt;header();</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                $template-&gt;assign(array(<span class="stringliteral">&quot;error&quot;</span> =&gt; 1,</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                    <span class="stringliteral">&quot;message&quot;</span> =&gt; <span class="stringliteral">&quot;Form not completed. Please complete the form&quot;</span>));</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                $template-&gt;display(<span class="stringliteral">&quot;install.ask_database_details.tpl&quot;</span>);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            }</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            <span class="comment">//Connect to database</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            $db-&gt;connect($host, $username, $password);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            <span class="comment">//Create Database</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            $db-&gt;query(<span class="stringliteral">&quot;CREATE DATABASE if not exists $database&quot;</span>);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            <span class="comment">//Select The given database</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            $db-&gt;select_db($database);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            <span class="comment">//Setup basic database</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            $this-&gt;<a class="code" href="classinstall.html#a8b2e00c7cc9a5031e9c98b4b6aa2c035">setup_database</a>();</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            <span class="comment">//Now create the config.php file save it</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            $file = fopen(<span class="stringliteral">&quot;config.php&quot;</span>, <span class="stringliteral">&quot;w+&quot;</span>);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            <span class="keywordflow">if</span> (!$file) {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                trigger_error(<span class="stringliteral">&quot;Error opening or creating config.php file&quot;</span>, E_USER_ERROR);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            $data = <span class="stringliteral">&quot;&lt;?php\n\$config[&#39;host&#39;]=&#39;$host&#39;;</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="stringliteral">                    \n\$config[&#39;username&#39;]=&#39;$username&#39;;</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="stringliteral">                    \n\$config[&#39;password&#39;]=&#39;$password&#39;;</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="stringliteral">                    \n\$config[&#39;database&#39;]=&#39;$database&#39;;</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="stringliteral">                    \n\$config[&#39;admin_email&#39;]=&#39;$adminEmail&#39;;    </span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="stringliteral">                    \n?&gt;&quot;</span>;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            $wr = fwrite($file, $data);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            fclose($file);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            <span class="comment">//Set file permission to 0644, Never leave this 0</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            <span class="keywordflow">if</span> (!chmod(<span class="stringliteral">&quot;config.php&quot;</span>, 0644)) {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                <span class="comment">//Read and write for the owner and read for everyone else</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                trigger_error(<span class="stringliteral">&quot;Cannot set config.php permissions&quot;</span>, E_USER_ERROR);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                <span class="comment">//Check if permissions have been successfull applied or not</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                <span class="keywordflow">if</span> (!is_readable(<span class="stringliteral">&quot;config.php&quot;</span>)) {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                    trigger_error(<span class="stringliteral">&quot;Wrong config.php permissions. Please give config.php file 644 permission. &lt;br&gt; Use the Following command&lt;br&gt;$ chmod 644 config.php&quot;</span>, E_USER_ERROR);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                }</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            }</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            $template-&gt;display(<span class="stringliteral">&quot;database_success.tpl&quot;</span>);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        }</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    }</div>
<div class="ttc" id="classinstall_html_a8b2e00c7cc9a5031e9c98b4b6aa2c035"><div class="ttname"><a href="classinstall.html#a8b2e00c7cc9a5031e9c98b4b6aa2c035">install\setup_database</a></div><div class="ttdeci">setup_database()</div><div class="ttdef"><b>Definition:</b> <a href="install_8php_source.html#l00229">install.php:229</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4e720dd6e62b63da8033cecf60d5eaed"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">install::check_directory_permission </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$sub</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function is used to check the required directories permission during the installation as FamilyTree needs to create some config files which can only be possible if he has the permission   $template </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$mode</td><td></td></tr>
    <tr><td class="paramtype">integer</td><td class="paramname">$sub</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="install_8php_source.html#l00055">55</a> of file <a class="el" href="install_8php_source.html">install.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                                                     {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        global $template;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        $cache = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        $compile = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        $main = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <span class="comment">//Check if directories are writable</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="comment">//Template Cache directory</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="keywordflow">if</span> (dir_iswritable(<span class="stringliteral">&quot;template/cache&quot;</span>)) {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            $cache = TRUE;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            $template-&gt;assign(<span class="stringliteral">&quot;cache&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!file_exists(<span class="stringliteral">&quot;template/cache&quot;</span>)) {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;            <span class="comment">//try making the directory if possible</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            @mkdir(<span class="stringliteral">&quot;template/cache&quot;</span>, 0755);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        }</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="comment">//Template compile directory</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <span class="keywordflow">if</span> (dir_iswritable(<span class="stringliteral">&quot;template/compile&quot;</span>)) {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            $compile = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            $template-&gt;assign(<span class="stringliteral">&quot;compile&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!file_exists(<span class="stringliteral">&quot;template/compile&quot;</span>)) {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            <span class="comment">//Trying to make the directory myself here</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            @mkdir(<span class="stringliteral">&quot;template/cache&quot;</span>, 0755);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <span class="comment">//Family Tree main directory</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        $template-&gt;assign(<span class="stringliteral">&quot;dir&quot;</span>, <span class="stringliteral">&quot;config.php&quot;</span>);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="keywordflow">if</span> (dir_iswritable(<span class="stringliteral">&quot;.&quot;</span>)) {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            $main = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;            $template-&gt;assign(<span class="stringliteral">&quot;main&quot;</span>, TRUE);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        }</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <span class="keywordflow">if</span> ($cache &amp;&amp; $compile &amp;&amp; $main) {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            header(<span class="stringliteral">&quot;Location: index.php?mode=ask_database_name&quot;</span>);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <span class="comment">//Apparently we cannot use template as we have not write permission in compile directory</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="comment">//So read the tpl file and output it as it is.</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <span class="comment">// We are using @ just in case we don&#39;t have permission to read</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        $output = file_get_contents(<span class="stringliteral">&quot;html/install.directory_check.tpl&quot;</span>);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="keywordflow">if</span> ($output === <span class="keyword">false</span>) {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            <span class="comment">//We also cannot read that file so just print a simple plain message</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            echo <span class="stringliteral">&quot;Please give permission to the root folder i.e. ./FamilyTree &lt;br /&gt; The template cache folder (template/cache) &lt;br /&gt; The template compile folder (template/compile) and refresh this page&quot;</span>;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        }</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        echo $output;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keywordflow">if</span> (!$cache) {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            echo <span class="stringliteral">&quot;&lt;h4&gt;Cannot write in template/cache folder&lt;/h4&gt;&lt;br&gt;&quot;</span>;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="keywordflow">if</span> (!$compile) {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;            echo <span class="stringliteral">&quot;&lt;h4&gt;Cannot write in template/compile folder&lt;/h4&gt;&lt;br&gt;&quot;</span>;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="keywordflow">if</span> (!$main) {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            echo <span class="stringliteral">&quot;&lt;h4&gt;Cannot write in FamilyTree&#39;s Directory&lt;/h4&gt;&lt;br&gt;&quot;</span>;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        }</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6a8bcb2f7b567c588f4a474d46804440"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">install::install </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function is used to start the installation.  string $mode  integer $sub </p>
<dl class="section return"><dt>Returns</dt><dd>null </dd></dl>

<p>Definition at line <a class="el" href="install_8php_source.html#l00019">19</a> of file <a class="el" href="install_8php_source.html">install.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;                       {</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;        global $mode, $sub;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;        <span class="comment">//make sure to run this only if database is not installed</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;        <span class="comment">//So check if database is installed</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;        <span class="keywordflow">if</span> (!empty($config) and file_exists(<span class="stringliteral">&quot;../config.php&quot;</span>)) {</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;            <span class="comment">//its installed! Return to index.php</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;            header(<span class="stringliteral">&quot;Location:../index.php&quot;</span>);</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        }</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        <span class="comment">//Reached here huh? Installtion will begin now</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        <span class="comment">//Check mode and perform actions</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        <span class="keywordflow">switch</span> ($mode) {</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;            <span class="comment">//All the other option will be above ask_database_name as it is also the default</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&quot;ask_database_name&quot;</span>:</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;                $this-&gt;<a class="code" href="classinstall.html#a27e554353c8f7b9eef9bc401f11765cf">ask_database_name</a>($mode, $sub);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&quot;setupAdmin&quot;</span>:</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;                $this-&gt;<a class="code" href="classinstall.html#a5c80f436b583ec38915827619d1e0fa1">setupAdmin</a>($mode, $sub);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&quot;check_directory_permission&quot;</span>:</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;            <span class="keywordflow">default</span> :</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                $this-&gt;<a class="code" href="classinstall.html#a4e720dd6e62b63da8033cecf60d5eaed">check_directory_permission</a>($mode, $sub);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        }</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    }</div>
<div class="ttc" id="classinstall_html_a27e554353c8f7b9eef9bc401f11765cf"><div class="ttname"><a href="classinstall.html#a27e554353c8f7b9eef9bc401f11765cf">install\ask_database_name</a></div><div class="ttdeci">ask_database_name($mode, $sub)</div><div class="ttdef"><b>Definition:</b> <a href="install_8php_source.html#l00156">install.php:156</a></div></div>
<div class="ttc" id="classinstall_html_a5c80f436b583ec38915827619d1e0fa1"><div class="ttname"><a href="classinstall.html#a5c80f436b583ec38915827619d1e0fa1">install\setupAdmin</a></div><div class="ttdeci">setupAdmin($mode, $sub)</div><div class="ttdef"><b>Definition:</b> <a href="install_8php_source.html#l00122">install.php:122</a></div></div>
<div class="ttc" id="classinstall_html_a4e720dd6e62b63da8033cecf60d5eaed"><div class="ttname"><a href="classinstall.html#a4e720dd6e62b63da8033cecf60d5eaed">install\check_directory_permission</a></div><div class="ttdeci">check_directory_permission($mode, $sub)</div><div class="ttdef"><b>Definition:</b> <a href="install_8php_source.html#l00055">install.php:55</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7d4d4748cd5c10e21c951a75e5a55f10"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">install::installTables </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This function is used install the tables in the database Returns true if all the tables were installed successfully else false   $db Ths instance of the db class </p>
<dl class="section return"><dt>Returns</dt><dd>boolean </dd></dl>

<p>Definition at line <a class="el" href="install_8php_source.html#l00244">244</a> of file <a class="el" href="install_8php_source.html">install.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                                     {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        global $db;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        $family = $db-&gt;query(<span class="stringliteral">&quot;Create table if not exists family (</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="stringliteral">            id int(11) primary key auto_increment,</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="stringliteral">            family_name mediumtext not null,</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="stringliteral">            ts int(11) not null )&quot;</span>);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        $member = $db-&gt;query(<span class="stringliteral">&quot;create table if not exists member (</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="stringliteral">            id int(11) null primary key auto_increment,</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="stringliteral">            membername mediumtext not null,</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="stringliteral">            username mediumtext default null,</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="stringliteral">            password mediumtext default null,</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="stringliteral">            sonof int(11) null default null,</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="stringliteral">            profilepic varchar(255) default &#39;common.png&#39;,</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="stringliteral">            dob int(11) default null,</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="stringliteral">            gender int(1) default 0,</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="stringliteral">            relationship_status int(11) default 0,</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="stringliteral">            gaon mediumtext default null,</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="stringliteral">            related_to int(11) null default null,</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="stringliteral">            emailid varchar(256) default null unique,</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="stringliteral">            alive int(1) default 0,</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="stringliteral">            aboutme longtext default null,</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="stringliteral">            lastlogin int(11) default null,</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="stringliteral">            joined int(11) default null,</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="stringliteral">            approved int(1) default 0,</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="stringliteral">            tokenforact text default null,</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="stringliteral">            dontshow int(1) default 0,</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="stringliteral">            family_id int(11) null default null,</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="stringliteral">            foreign key (family_id) references family(id),</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="stringliteral">            foreign key (related_to) references member(id),</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="stringliteral">            admin int(1) default 0 )&quot;</span>);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        $feedback = $db-&gt;query(<span class="stringliteral">&quot;create table if not exists feedback (</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="stringliteral">            id int(11) not null primary key auto_increment,</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="stringliteral">            user_name text not null,</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="stringliteral">            user_emailid text not null,</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="stringliteral">            feedback_text text not null,</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="stringliteral">            seen int(1) default 0 );&quot;</span>);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        $joinrequest = $db-&gt;query(<span class="stringliteral">&quot;create table if not exists joinrequest (</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="stringliteral">            id int(11) not null primary key auto_increment,</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="stringliteral">            formember int(11) not null,</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="stringliteral">            pic text default null,</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="stringliteral">            personalmessage text default null,</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="stringliteral">            emailid text not null,</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="stringliteral">            tokenforact varchar(20) default null,</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="stringliteral">            approved int(1) default 0,</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="stringliteral">            foreign key(formember) references member(id) );&quot;</span>);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        $suggested_info = $db-&gt;query(<span class="stringliteral">&quot;create table if not exists suggested_info (</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="stringliteral">            id int(11) not null primary key auto_increment,</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="stringliteral">            typesuggest mediumtext not null,</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="stringliteral">            new_value text default null,</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="stringliteral">            old_value text default null,</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="stringliteral">            suggested_by int(11) not null,</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="stringliteral">            suggested_to int(11) not null,</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="stringliteral">            ts int(11) not null,</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="stringliteral">            approved int(1) default 0,</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="stringliteral">            foreign key(suggested_by) references member(id),</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="stringliteral">            foreign key(suggested_to) references member(id) );&quot;</span>);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        $suggest_approved = $db-&gt;query(<span class="stringliteral">&quot;create table if not exists suggest_approved (</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="stringliteral">            id int(11) not null primary key auto_increment,</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="stringliteral">            suggest_id int(11) not null,</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="stringliteral">            user_id int(11) not null,</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="stringliteral">            action int(2) not null,</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="stringliteral">            foreign key (suggest_id) references suggested_info(id),</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="stringliteral">            foreign key (user_id) references member(id) );&quot;</span>);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <span class="comment">//Commenting this out as we have ask user about the new family from now on.</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <span class="comment">//$dasfamily = $db-&gt;query(&quot;insert into family (family_name,ts) values(&#39;Das Family&#39;,&quot; . time() . &quot;);&quot;);</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        <span class="comment">//Now the data that we already have</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <span class="comment">//Commenting this out, as we don&#39;t have any default family data from now on.</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <span class="comment">//$memberdata = file_get_contents(&quot;member_data.sql&quot;);</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <span class="comment">//$memberdata_sql = $db-&gt;query($memberdata);</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <span class="keywordflow">return</span> $member &amp;&amp; $feedback &amp;&amp; $joinrequest &amp;&amp; $suggested_info &amp;&amp; $suggest_approved <span class="comment">/* &amp;&amp; $memberdata_sql */</span> &amp;&amp; $family <span class="comment">/* &amp;&amp; $dasfamily */</span>;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8b2e00c7cc9a5031e9c98b4b6aa2c035"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">install::setup_database </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This is a private function used to setup the database   $db </p>

<p>Definition at line <a class="el" href="install_8php_source.html#l00229">229</a> of file <a class="el" href="install_8php_source.html">install.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                                      {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        global $db;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="comment">//Install the tables</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <span class="keywordflow">if</span> (!$this-&gt;<a class="code" href="classinstall.html#a7d4d4748cd5c10e21c951a75e5a55f10">installTables</a>()) {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            trigger_error(<span class="stringliteral">&quot;Cannot create Tables&quot;</span>, E_USER_ERROR);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    }</div>
<div class="ttc" id="classinstall_html_a7d4d4748cd5c10e21c951a75e5a55f10"><div class="ttname"><a href="classinstall.html#a7d4d4748cd5c10e21c951a75e5a55f10">install\installTables</a></div><div class="ttdeci">installTables()</div><div class="ttdef"><b>Definition:</b> <a href="install_8php_source.html#l00244">install.php:244</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5c80f436b583ec38915827619d1e0fa1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">install::setupAdmin </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$sub</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>$template   $db </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">type</td><td class="paramname">$mode</td><td></td></tr>
    <tr><td class="paramtype">type</td><td class="paramname">$sub</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="install_8php_source.html#l00122">122</a> of file <a class="el" href="install_8php_source.html">install.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                                     {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        global $template, $db, $vanshavali;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        $sub = ($sub == null) ? <span class="stringliteral">&quot;firstfamily&quot;</span> : $sub;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="keywordflow">if</span> ($sub == <span class="stringliteral">&quot;firstfamily&quot;</span>) {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            $template-&gt;header();</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            $template-&gt;display(<span class="stringliteral">&quot;family.form.tpl&quot;</span>);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            $template-&gt;footer();</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($sub == <span class="stringliteral">&quot;firstfamilypost&quot;</span>) {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            <span class="comment">//This just means that user has submitted the firstfamily form</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            $vanshavali-&gt;addfamily($_POST[<span class="stringliteral">&#39;family_name&#39;</span>]) or trigger_error(<span class="stringliteral">&quot;Unable to add family. Please try again&quot;</span>);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            <span class="comment">//We have added the first family. Lets proceed to add first member</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            header(<span class="stringliteral">&quot;Location: index.php?mode=setupAdmin&amp;sub=firstmember&quot;</span>);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($sub == <span class="stringliteral">&quot;firstmember&quot;</span>) {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            <span class="comment">//This is where we find out that there is no member installed</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            <span class="comment">//We need to first get the family that was just added for this member</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            $family = $db-&gt;get(<span class="stringliteral">&quot;select * from family limit 1&quot;</span>);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            $template-&gt;header();</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            $template-&gt;assign(<span class="stringliteral">&quot;is_admin&quot;</span>, 1);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            $template-&gt;assign(<span class="stringliteral">&quot;familyid&quot;</span>, $family[<span class="stringliteral">&#39;id&#39;</span>]);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            $template-&gt;display(<span class="stringliteral">&quot;register.form.tpl&quot;</span>);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            $template-&gt;footer();</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        }</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>install/<a class="el" href="install_8php_source.html">install.php</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classinstall.html">install</a></li>
    <li class="footer">Generated on Sun Jun 12 2016 20:56:15 for Family Tree by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
