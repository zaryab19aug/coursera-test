<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Family Tree: auth Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Family Tree
   &#160;<span id="projectnumber">0.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classauth.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classauth-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">auth Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for auth:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classauth.png" usemap="#auth_map" alt=""/>
  <map id="auth_map" name="auth_map">
<area href="classuser.html" alt="user" shape="rect" coords="0,56,37,80"/>
<area href="classuser.html" alt="user" shape="rect" coords="47,56,84,80"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a476f6d06e1ddb49cf4268918363c1d99"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classauth.html#a476f6d06e1ddb49cf4268918363c1d99">__construct</a> ()</td></tr>
<tr class="memitem:a019d664334a621e770043d9fb4210836"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classauth.html#a019d664334a621e770043d9fb4210836">authenticate</a> ($username, $password)</td></tr>
<tr class="memitem:a0de1d4416c9fb04b4223cd7a3dd3a623"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classauth.html#a0de1d4416c9fb04b4223cd7a3dd3a623">user_account_activated</a> ($id)</td></tr>
<tr class="memitem:aebf5c1995f3314883dc475628db61ccc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classauth.html#aebf5c1995f3314883dc475628db61ccc">get_user</a> ($id)</td></tr>
<tr class="memitem:ad5c908efc480a57e5625131348f4bf29"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classauth.html#ad5c908efc480a57e5625131348f4bf29">check_session</a> ()</td></tr>
<tr class="memitem:ac2530bf2bba79e22de7e2f3ebb63be3a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classauth.html#ac2530bf2bba79e22de7e2f3ebb63be3a">check_token</a> ($id, $token)</td></tr>
<tr class="memitem:a73a5af5d9e12014687cf0d360f5e6356"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classauth.html#a73a5af5d9e12014687cf0d360f5e6356">is_authenticated</a> ()</td></tr>
<tr class="memitem:a4ec05ca8231cd1151246b127f168d457"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classauth.html#a4ec05ca8231cd1151246b127f168d457">generate_token</a> ($id= '')</td></tr>
<tr class="memitem:adeb7a80afb02aceb540c541d591baf69"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classauth.html#adeb7a80afb02aceb540c541d591baf69">destroy_session</a> ()</td></tr>
<tr class="memitem:a17089bfa7c3b9d0546f80ac9472dfc7b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classauth.html#a17089bfa7c3b9d0546f80ac9472dfc7b">unauthenticate</a> ()</td></tr>
</table>
<a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>This class is used to create and destroy sessions. It also handles User Authentication </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">none</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>piyush </dd></dl>

<p>Definition at line <a class="el" href="auth_8php_source.html#l00007">7</a> of file <a class="el" href="auth_8php_source.html">auth.php</a>.</p>
</div><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a476f6d06e1ddb49cf4268918363c1d99"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">auth::__construct </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The constructor of the class </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">null</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented in <a class="el" href="classuser.html#acf59e1e14564ce949759964415069581">user</a>.</p>

<p>Definition at line <a class="el" href="auth_8php_source.html#l00013">13</a> of file <a class="el" href="auth_8php_source.html">auth.php</a>.</p>
<div class="fragment"><div class="line">                                  {</div>
<div class="line">        session_start();</div>
<div class="line">    }</div>
</div><!-- fragment -->
</div>
</div>
<h2>Member Function Documentation</h2>
<a class="anchor" id="a019d664334a621e770043d9fb4210836"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">auth::authenticate </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$username</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$password</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function is used to basically log-in the user. It takes username and password combination as parameter and return true if such user is present and authentication process was successfully completed. If no such user is present it returns false   $db The instance of the the db class  array $_SESSION The global Session variable storing all the session data </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$username</td><td>The username of the users to check against </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$password</td><td>The password of the user </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>boolean </dd></dl>

<p>Definition at line <a class="el" href="auth_8php_source.html#l00029">29</a> of file <a class="el" href="auth_8php_source.html">auth.php</a>.</p>
<div class="fragment"><div class="line">                                                       {</div>
<div class="line">        global $db;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">//Convert Password in md5 Hash</span></div>
<div class="line">        $password = md5($password);</div>
<div class="line">        $query = $db-&gt;query(<span class="stringliteral">&quot;select * from member where username=&#39;$username&#39; and password=&#39;$password&#39;&quot;</span>);</div>
<div class="line">        $row = $db-&gt;fetch($query);</div>
<div class="line"></div>
<div class="line">        <span class="comment">//if no row found or if user&#39;s account is not activated yet then</span></div>
<div class="line">        <span class="keywordflow">if</span> ($row == <span class="keyword">false</span>) {</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        <span class="comment">//Check here for approval if user registration has been approved by the admin. Currently disabled</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">//Start the session and start storing data about user</span></div>
<div class="line">        global $_SESSION;</div>
<div class="line">        $token = $this-&gt;<a class="code" href="classauth.html#a4ec05ca8231cd1151246b127f168d457">generate_token</a>($row[<span class="stringliteral">&#39;id&#39;</span>]);</div>
<div class="line">        $_SESSION[<span class="stringliteral">&#39;membername&#39;</span>] = $row[<span class="stringliteral">&#39;membername&#39;</span>];</div>
<div class="line">        $_SESSION[<span class="stringliteral">&#39;id&#39;</span>] = $row[<span class="stringliteral">&#39;id&#39;</span>];</div>
<div class="line">        $_SESSION[<span class="stringliteral">&#39;token&#39;</span>] = $token;</div>
<div class="line">        $_SESSION[<span class="stringliteral">&#39;authenticated&#39;</span>] = <span class="keyword">true</span>;</div>
<div class="line"></div>
<div class="line">        <span class="comment">//if everything is alright then return true</span></div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad5c908efc480a57e5625131348f4bf29"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">auth::check_session </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function is used to check if sessions was initialized i.e. all the required cookies are set. Return true if set  array $_SESSION The Superglobal Session variable </p>
<dl class="section return"><dt>Returns</dt><dd>boolean </dd></dl>

<p>Definition at line <a class="el" href="auth_8php_source.html#l00089">89</a> of file <a class="el" href="auth_8php_source.html">auth.php</a>.</p>
<div class="fragment"><div class="line">                             {</div>
<div class="line">        global $_SESSION;</div>
<div class="line">        <span class="keywordflow">if</span> (isset($_SESSION[<span class="stringliteral">&#39;membername&#39;</span>], $_SESSION[<span class="stringliteral">&#39;id&#39;</span>], $_SESSION[<span class="stringliteral">&#39;token&#39;</span>], $_SESSION[<span class="stringliteral">&#39;authenticated&#39;</span>])) {</div>
<div class="line">            <span class="keywordflow">if</span> ($_SESSION[<span class="stringliteral">&#39;authenticated&#39;</span>] == <span class="keyword">true</span>) {</div>
<div class="line">                <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classauth.html#ac2530bf2bba79e22de7e2f3ebb63be3a">check_token</a>($_SESSION[<span class="stringliteral">&#39;id&#39;</span>], $_SESSION[<span class="stringliteral">&#39;token&#39;</span>])) {</div>
<div class="line">                    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac2530bf2bba79e22de7e2f3ebb63be3a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">auth::check_token </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$token</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function is used to checkt the token generated against the user. Return true if matches </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">integer</td><td class="paramname">$id</td><td>The ID of the user </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$token</td><td>The token generated for the user </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>boolean </dd></dl>

<p>Definition at line <a class="el" href="auth_8php_source.html#l00109">109</a> of file <a class="el" href="auth_8php_source.html">auth.php</a>.</p>
<div class="fragment"><div class="line">                                      {</div>
<div class="line">        $numtoken = preg_replace(<span class="stringliteral">&quot;/[^0-9]/&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, $token);</div>
<div class="line">        $numtoken = (int) $numtoken;</div>
<div class="line">        <span class="keywordflow">if</span> ($numtoken == $id) {</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="adeb7a80afb02aceb540c541d591baf69"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">auth::destroy_session </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function is used to destroy the session created </p>
<dl class="section return"><dt>Returns</dt><dd>null </dd></dl>

<p>Definition at line <a class="el" href="auth_8php_source.html#l00167">167</a> of file <a class="el" href="auth_8php_source.html">auth.php</a>.</p>
<div class="fragment"><div class="line">    {</div>
<div class="line">        session_unset();</div>
<div class="line">    }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4ec05ca8231cd1151246b127f168d457"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">auth::generate_token </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$id</em> = <code>''</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function is generated token for a user. Token is a random alphanumeric string </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">integer</td><td class="paramname">$id</td><td>The ID of the used to generate the token for. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string The generated Token </dd></dl>

<p>Definition at line <a class="el" href="auth_8php_source.html#l00140">140</a> of file <a class="el" href="auth_8php_source.html">auth.php</a>.</p>
<div class="fragment"><div class="line">                                      {</div>
<div class="line"></div>
<div class="line">        $codelenght = 20;</div>
<div class="line">        <span class="keywordflow">for</span> ($newcode = <span class="stringliteral">&quot;&quot;</span>, $newcode_length = 0; $newcode_length &lt; $codelenght; $newcode_length++) {</div>
<div class="line">            <span class="keywordflow">if</span> ($newcode_length == 5) {</div>
<div class="line">                $newcode = $newcode . $id;</div>
<div class="line">            }</div>
<div class="line">            $x = 1;</div>
<div class="line">            $y = 2;</div>
<div class="line">            $part = rand($x, $y);</div>
<div class="line">            <span class="keywordflow">if</span> ($part == 1) {</div>
<div class="line">                $a = 65;</div>
<div class="line">                $b = 90;</div>
<div class="line">            } <span class="comment">// UpperCase</span></div>
<div class="line">            <span class="keywordflow">if</span> ($part == 2) {</div>
<div class="line">                $a = 97;</div>
<div class="line">                $b = 122;</div>
<div class="line">            } <span class="comment">// LowerCase</span></div>
<div class="line">            $newcode = $newcode . chr(rand($a, $b));</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> $newcode;</div>
<div class="line">    }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aebf5c1995f3314883dc475628db61ccc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">auth::get_user </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function returns all the information of the user in array just as it is stored in the table   $db The instance of the db class </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">type</td><td class="paramname">$id</td><td>The ID of the user for which the information is to be fetched </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>array </dd></dl>

<p>Definition at line <a class="el" href="auth_8php_source.html#l00077">77</a> of file <a class="el" href="auth_8php_source.html">auth.php</a>.</p>
<div class="fragment"><div class="line">                           {</div>
<div class="line">        global $db;</div>
<div class="line">        $row = $db-&gt;fetch($db-&gt;query(<span class="stringliteral">&quot;select * from member where id=$id&quot;</span>));</div>
<div class="line">        <span class="keywordflow">return</span> $row;</div>
<div class="line">    }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a73a5af5d9e12014687cf0d360f5e6356"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">auth::is_authenticated </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function is used to check if the user is logged-in Returns true if logged-in </p>
<dl class="section return"><dt>Returns</dt><dd>boolean </dd></dl>

<p>Definition at line <a class="el" href="auth_8php_source.html#l00126">126</a> of file <a class="el" href="auth_8php_source.html">auth.php</a>.</p>
<div class="fragment"><div class="line">                                {</div>
<div class="line">        <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classauth.html#ac2530bf2bba79e22de7e2f3ebb63be3a">check_token</a>($_SESSION[<span class="stringliteral">&#39;id&#39;</span>], $_SESSION[<span class="stringliteral">&#39;token&#39;</span>]) &amp;&amp; $_SESSION[<span class="stringliteral">&#39;authenticated&#39;</span>]) {</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a17089bfa7c3b9d0546f80ac9472dfc7b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">auth::unauthenticate </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function is used to log-out the user   $db The instance of the db class </p>
<dl class="section return"><dt>Returns</dt><dd>boolean </dd></dl>

<p>Definition at line <a class="el" href="auth_8php_source.html#l00177">177</a> of file <a class="el" href="auth_8php_source.html">auth.php</a>.</p>
<div class="fragment"><div class="line">    {</div>
<div class="line">        global $db;</div>
<div class="line">        <span class="keywordflow">if</span> (!$this-&gt;<a class="code" href="classauth.html#a73a5af5d9e12014687cf0d360f5e6356">is_authenticated</a>())</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="comment">//Update the last login timestamp</span></div>
<div class="line">        <span class="keywordflow">if</span> ($db-&gt;query(<span class="stringliteral">&quot;update member set lastlogin=&quot;</span>.time().<span class="stringliteral">&quot; where id=&quot;</span>.$_SESSION[<span class="stringliteral">&#39;id&#39;</span>]))</div>
<div class="line">        {</div>
<div class="line">        </div>
<div class="line">        <span class="comment">//Unset all the session values</span></div>
<div class="line">        $this-&gt;<a class="code" href="classauth.html#adeb7a80afb02aceb540c541d591baf69">destroy_session</a>();</div>
<div class="line">        <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classauth.html#a73a5af5d9e12014687cf0d360f5e6356">is_authenticated</a>())</div>
<div class="line">        {</div>
<div class="line">            trigger_error(<span class="stringliteral">&quot;Error Ending Session&quot;</span>,E_USER_ERROR);</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0de1d4416c9fb04b4223cd7a3dd3a623"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">auth::user_account_activated </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function is used to check if user's account has been approved by the admin </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">type</td><td class="paramname">$id</td><td>The ID of the user to check for </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>boolean </dd></dl>

<p>Definition at line <a class="el" href="auth_8php_source.html#l00061">61</a> of file <a class="el" href="auth_8php_source.html">auth.php</a>.</p>
<div class="fragment"><div class="line">                                         {</div>
<div class="line"></div>
<div class="line">        $data = $this-&gt;<a class="code" href="classauth.html#aebf5c1995f3314883dc475628db61ccc">get_user</a>($id);</div>
<div class="line">        <span class="keywordflow">if</span> ($data[<span class="stringliteral">&#39;approved&#39;</span>] == 0) {</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>auth/<a class="el" href="auth_8php_source.html">auth.php</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classauth.html">auth</a></li>
<<<<<<< HEAD
    <li class="footer">Generated on Mon Jan 6 2014 23:06:59 for Family Tree by
=======
    <li class="footer">Generated on Mon Nov 11 2013 18:54:12 for Family Tree by
>>>>>>> selfuser
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.1.2 </li>
  </ul>
</div>
</body>
</html>
